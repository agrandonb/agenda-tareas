<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Tareas Diario - Dashboard</title>
  <link rel="stylesheet" href="estilos.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

<header class="dashboard-header">
  <h1>Registro de Tareas Diario</h1>
  <div class="dia-semana" id="diaSemana" aria-live="polite"></div>
  <div class="header-right" id="botonEditarContainer"></div>
</header>

<div class="contenedor" id="contenedorTareas"></div>

<section class="caja-notas caja" aria-label="Notas del d√≠a">
  <h2>Notas:</h2>
  <textarea id="notasDia" placeholder="Escribe tus notas aqu√≠..." aria-label="Notas del d√≠a"></textarea>
</section>

<div class="botones-opciones">
  <button onclick="exportarCSV()">Exportar CSV</button>
  <button onclick="limpiarAntiguos()">Limpiar Registros Antiguos</button>
</div>

<section aria-labelledby="tituloCalendario">
  <h2 class="titulo-calendario" id="tituloCalendario" onclick="toggleElemento('tituloCalendario','contenedorCalendario')">üìÖ Calendario</h2>
  <div id="contenedorCalendario" class="caja" role="region" aria-hidden="true">

    <div class="fila-calendario">
      <label for="fechaSeleccion">Selecciona una fecha:</label>
      <input type="date" id="fechaSeleccion" class="fecha-input visible">
      <button id="btnIrFecha">üóìÔ∏è Ir a fecha</button>
    </div>

    <div class="fila-calendario">
      <label for="selectCaja">Selecciona caja:</label>
      <select id="selectCaja"></select>
      <label for="nuevaTareaCalendario">Nueva tarea:</label>
      <input type="text" id="nuevaTareaCalendario" placeholder="Escribe nueva tarea...">
    </div>

    <div class="fila-calendario">
      <button id="btnAddFecha">‚ûï Solo este d√≠a</button>
      <button id="btnAddFija">üìå Fijo este d√≠a de la semana</button>
      <button id="btnAddTodosDias">üìÖ Todos los d√≠as</button>
    </div>
  </div>
</section>

<section aria-labelledby="tituloHistorial">
  <h2 class="titulo-historial" id="tituloHistorial" onclick="toggleElemento('tituloHistorial','historial')">Historial</h2>
  <div class="historial-container caja" id="historial" role="region" aria-hidden="true"></div>
</section>

<section aria-labelledby="tituloGraficos">
  <h2 class="titulo-graficos" id="tituloGraficos" onclick="toggleElemento('tituloGraficos','contenedorGraficos')">üìä Gr√°ficos</h2>
  <button id="btnConfigGraficos" onclick="toggleConfigGraficos()" aria-expanded="false" aria-controls="panelConfigGraficos">‚öôÔ∏è Configuraci√≥n de Gr√°ficos</button>
  <div id="panelConfigGraficos" class="caja" role="region" aria-hidden="true">
    <label for="rangoGraficoCumplimiento">Rango gr√°fico Cumplimiento:</label>
    <select id="rangoGraficoCumplimiento" onchange="actualizarGraficos()">
      <option value="7d">√öltimos 7 d√≠as</option>
      <option value="mes" selected>Mes actual</option>
      <option value="anio">A√±o actual</option>
    </select>
    <label for="tipoGraficoCumplimiento" style="margin-left:10px;">Tipo gr√°fico Cumplimiento:</label>
    <select id="tipoGraficoCumplimiento" onchange="actualizarGraficos()">
      <option value="line">Lineal</option>
      <option value="bar" selected>Barras</option>
    </select>
    <label for="rangoGraficoHoras" style="margin-left:10px;">Rango gr√°fico Horas:</label>
    <select id="rangoGraficoHoras" onchange="actualizarGraficos()">
      <option value="7d">√öltimos 7 d√≠as</option>
      <option value="mes" selected>Mes actual</option>
      <option value="anio">A√±o actual</option>
    </select>
    <label for="tipoGraficoHoras" style="margin-left:10px;">Tipo gr√°fico Horas:</label>
    <select id="tipoGraficoHoras" onchange="actualizarGraficos()">
      <option value="bar" selected>Barras</option>
      <option value="line">Lineal</option>
    </select>
  </div>
  <div id="contenedorGraficos" class="caja" role="region" aria-hidden="true">
    <div class="graficos-container">
      <canvas id="graficoCumplimiento" role="img" aria-label="Gr√°fico de cumplimiento"></canvas>
      <canvas id="graficoHoras" role="img" aria-label="Gr√°fico de horas"></canvas>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js"></script>
<script>
  function toggleElemento(tituloId, contenedorId) {
    const titulo = document.getElementById(tituloId);
    const cont = document.getElementById(contenedorId);
    const visible = cont.classList.contains("show");
    cont.classList.toggle("show", !visible);
    titulo.classList.toggle("abierto", !visible);
    cont.setAttribute("aria-hidden", visible);
  }

  function toggleConfigGraficos() {
    const panel = document.getElementById("panelConfigGraficos");
    const expanded = panel.classList.toggle("show");
    panel.setAttribute("aria-hidden", !expanded);
    document.getElementById("btnConfigGraficos").setAttribute("aria-expanded", expanded);
  }
</script>
</body>
</html>
